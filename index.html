<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Santa Tracker PH ğŸ…</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<style>
body {
  margin: 0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  background: radial-gradient(circle at top, #0e2a47 0%, #061327 65%);
  color: #fff;
}

header {
  background: linear-gradient(135deg, #b1121f, #6b0000);
  padding: 8px;
  text-align: center;
}

#map { height: 60vh; }

.santa {
  animation: float 1.6s ease-in-out infinite;
}

@keyframes float {
  0% { transform: translateY(0); }
  50% { transform: translateY(-6px); }
  100% { transform: translateY(0); }
}

.toast {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: black;
  padding: 12px 16px;
  border-radius: 14px;
  display: none;
  z-index: 9999;
}
</style>
</head>

<body>

<header>
  <h1>ğŸ… Santa Tracker PH</h1>
  <p>Malapit na si Santa! ğŸ</p>
</header>

<div id="map"></div>

<div class="toast" id="toast">ğŸ”Š Tap anywhere to enable sound</div>

<audio id="music" autoplay loop muted playsinline>
  <source src="https://cdn.pixabay.com/download/audio/2022/12/15/audio_7b3a96e7f1.mp3" type="audio/mpeg">
</audio>

<audio id="hoho" playsinline>
  <source src="https://cdn.pixabay.com/download/audio/2021/12/22/audio_3e3b9b1c7d.mp3" type="audio/mpeg">
</audio>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
const map = L.map('map').setView([12.8797, 121.7740], 6);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
  attribution: 'Â© OpenStreetMap'
}).addTo(map);

/* âœ… WORKING SANTA ICON */
const santaIcon = L.divIcon({
  className: '',
  html: `<img src="https://raw.githubusercontent.com/twitter/twemoji/master/assets/svg/1f385.svg" class="santa" width="48"/>`,
  iconSize: [48, 48],
  iconAnchor: [24, 24]
});

let santa = L.marker([12.8797, 121.7740], { icon: santaIcon })
  .addTo(map)
  .bindPopup('ğŸ… Santa is coming!');

let userLat = 12.8797;
let userLng = 121.7740;

let path = L.polyline([[12.8797,121.7740],[userLat,userLng]],
{ color:'yellow', dashArray:'5,10' }).addTo(map);

/* Santa movement */
function moveSanta() {
  let p = santa.getLatLng();
  let lat = p.lat + (Math.random() - 0.5) * 0.03;
  let lng = p.lng + (Math.random() - 0.5) * 0.03;
  santa.setLatLng([lat, lng]);
  path.setLatLngs([[lat,lng],[userLat,userLng]]);
  setTimeout(moveSanta, 4000);
}
moveSanta();

/* Geolocation */
if (navigator.geolocation) {
  navigator.geolocation.getCurrentPosition(pos => {
    userLat = pos.coords.latitude;
    userLng = pos.coords.longitude;
    path.setLatLngs([santa.getLatLng(), [userLat,userLng]]);
  });
}

/* ğŸ”Š Audio unlock */
const music = document.getElementById('music');
const toast = document.getElementById('toast');

toast.style.display = 'block';

document.addEventListener('click', () => {
  if (music.muted) {
    music.muted = false;
    music.volume = 0.6;
    music.play();
    toast.style.display = 'none';
  }
}, { once:true });
</script>

</body>
</html>
